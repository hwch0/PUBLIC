<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kr.pub.dao.ItemDAO">



  <select id="itemList" resultType="java.util.Map">
    <![CDATA[
      SELECT
        i.ITEM_ID AS itemId,
        i.ITEM_NAME AS itemName,
        c.TYPE AS type,
        MIN(s.STORE_DATE) AS storeDate,
        MAX(s.STORE_DATE) AS storeDate,
        i.STOCK AS stock,
        sh.PRICE AS price
      FROM
        item i
      LEFT JOIN
        store_history sh ON i.ITEM_ID = sh.ITEM_ID
      LEFT JOIN
        store s ON sh.STORE_ID = s.STORE_ID
      LEFT JOIN
        common_code c ON i.ITEM_TYPE_CODE = c.CODE
      GROUP BY
        i.ITEM_ID, i.ITEM_NAME, i.ITEM_TYPE_CODE, c.TYPE, i.STOCK, sh.PRICE;
    ]]>
  </select>

	
</mapper>